# 基于Linux的（怎么换成和嵌入式相关的前缀？）并发终端监控平台

## 项目简述

本项目以智能安防为背景，开发集群服务器和嵌入式终端软件。并发服务器基于Linux平台，实现终端消息转发和流媒体服务；终端软件实现端到端的通讯和监控功能。首先，监控双端要添加对方到各自设备列表，通过设备列表选择在线设备发起监控请求，被监控方收到请求消息后将摄像头数据流推送到服务器，并将推送地址反馈到监控方，监控方从而完成拉流，并将监控画面进行显示。

## 主要工作

1. 使用基于Reactor模型的muduo网络库作为核心模块，基于epoll同步IO多路复用提供并发服务，通过网络层事件回调和业务层函数装饰器等统一管理可调用对象解耦不同层级的代码。
2. 配置反向代理服务器Nginx基于weight轮询的Tcp负载均衡，实现服务器的集群功能，提高后端服务并发能力。
3. 基于Redis的发布-订阅功能实现集群服务器间的消息转发，通过多线程方式阻塞接收通道消息，并通过函数句柄上报业务层。
4. 基于FFmpeg对摄像头设备进行H264编解码，通过rtmp方式推流到服务器，从而在监控端进行显示，终端的推拉流任务通过线程池方式提升效率，拉流端采用队列存储解码后的RGB数据，并调用定时器渲染显示在界面。
5. 监控流通过QT渲染显示，采用多线程方式实现业务处理和界面实时显示，构建静态内部类单例设计模式的信号转发类，用于解耦不同窗体类的嵌套关系。
6. 使用MySQL作为数据的落地存储，采用一定程度的反范式设计提升性能；使用单例设计模式构建数据库连接池类，并用队列+互斥锁结构存储空闲连接，使用条件变量实现线程同步，通过重定义智能指针析构函数实现连接的自动归还。
